# 一、什么是微服务

将一个完整的应用（单体应用）按照一定的拆分规则（后文讲述）拆分成多个不同的服务，每个服务都能独立地进行开发、部署、扩展。服务于服务之间通过注入RESTful api或其他方式调用

​每个服务运行在其独立的进程中，服务与服务之间采用轻量级的通信机制互相沟通（Spring Cloud基于HTTP的RESTFul API，阿里云dubbo基于RPC），每个服务都围绕其具体业务进行构建，并且能够被独立地部署到生产环境。微服务的优势在于规避统一集中式的服务管理，对于每一个服务而言都可以根据业务上下文的特征选择合适的语言、工具对其进行构建

# 二、Spring Cloud组件架构

## 1.SpringCloud概念

​SpringCloud是一系列框架的有序集合，利用Spring Boot开发的便利性简化分布式系统基础设施的开发。Spring是将开发比较成熟的服务框架组合起来，通过SpringBoot风格进行再封装，屏蔽复杂的配置和实现原理。

## 2.SpringCloud组件架构



​工作流程：所有请求（包括网页、app等不同媒介）通过统一的API网关（**Zuul**）访问内部服务

​ 网关接收请求后，从注册中心（**EurekaServer**）获取可用服务

​ 由**Ribbon**进行负载均衡后，分发到后端的具体实例

​ 微服务之间通过**Feign**进行通信处理业务

​**Hystrix**负责处理服务之间的超时熔断（即网络链接断掉后如何处理）

​**Turbine**监控服务间的调用和熔断的相关指标

​\*注：SpringCloud架构体系的所有微服务都通过Zuul来对提供统一的访问入口，所有需要和微服务架构内部服务进行通讯的请求都走统一的网关API\*

Eureka服务发现与Ribbon客户端负载均衡的结合，为内部“微服务”提供通信支持，但是，如果你想要与外界通信时（你提供外部API，或只是从你的页面使用AJAX），将各种服务隐藏在一个代理之后是一个明智的选择。Ribbon 是 Netflix 发布的云中间层服务开源项目，其主要功能是提供客户侧软件负载均衡算法。

## 3.SpringCloud核心功能

​分布式/版本化配置、服务注册和发现、路由、服务和服务之间的调用、负载均衡、断路器、分布式消息传递

​微服务是一种架构理念，提出了微服务的设计原则，从理论为具体的技术提供指导，Springboot是一套快速配置的脚手架，可以基于SpringBoot开发单个微服务。SpringCloud是一个基于SpringBoot实现的服务治理工具包，**Springboot专注于快速、方便集成的单个微服务个体；SpringCloud关注全局的服务治理框架**

# 三、微服务架构设计概念

## 1.服务种类

基础服务：一些基础组件，与具体业务无关；例如：短信服务、邮件服务、文件存储服务、消息通知服务、邮件服务…...

业务服务：一些垂直的业务系统，只处理单一的业务类型；

前置服务：服务的接入或者输出服务，比如网站的前端服务、app的服务接口等等

## 2.服务拆分

横向拆分：按照不同的业务域进行拆分，例如卫生间、厨房等等形成独立的业务域微服务集群

纵向拆分：把横向拆分的业务域根据不同模块和组件进行拆分，例如公共组件拆分成独立的原子服务、厨房拆分到具体每个传感器锁提供的服务（例如燃气、冰箱等等）

## 3.步骤方法

* 在确定使用SpringBoot/Cloud技术下进行微服务之前，要先梳理出系统的服务，对不同的服务进行分类，以确认演化的节奏

* 熟悉SpringBoot技术，优先在基础服务上进行微服务设计

* SpringBoot对每一个微服务设计完成后，使用SpringCloud进行整个项目系统的改造

* 前期可以少量项目进行微服务化，逐渐推进整体微服务化

# 四、微服务数据库挑战

持续更新……...

因为微服务数据库部分相对比较复杂，后续在进行细节切分，先将微服务数据库搭建起来

